(self.webpackChunkslides=self.webpackChunkslides||[]).push([[179],{2904:(e,t,l)=>{"use strict";l.r(t),l.d(t,{slides:()=>r,backgrounds:()=>p,fragmentSteps:()=>s,fusumaProps:()=>k,default:()=>u});var n=l(7401),a=l(9332);l(108),l(4819),l(6066),l(1687),l(4780);function i(){return i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var l=arguments[t];for(var n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n])}return e},i.apply(this,arguments)}const r=[e=>(0,a.kt)(n.Fragment,null,(0,a.kt)("h1",null,"60分で学ぶ実践E2Eテスト（実装編）")),e=>(0,a.kt)(n.Fragment,null,(0,a.kt)("h1",null,"はじめに")),e=>(0,a.kt)(n.Fragment,null,(0,a.kt)("h2",null,"E2Eテストコード、書いてますか？")),e=>(0,a.kt)(n.Fragment,null,(0,a.kt)("h2",null,"何に困ってますか？"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"書きたいと思ってるんだけど、ググるといろんなやり方が出てきて、どれが良いやり方なのかわからない"),(0,a.kt)("li",{parentName:"ul"},"昔チャレンジしたんだけど、メンテナンスが上手く行かなかった"),(0,a.kt)("li",{parentName:"ul"},"勉強する時間がない、正解を教えてほしい"))),e=>(0,a.kt)(n.Fragment,null,(0,a.kt)("h2",null,"今日話すこと"),(0,a.kt)("p",null,"時間もあんまり無いので、 ",(0,a.kt)("strong",{parentName:"p"},"個人的ベストプラクティス")," にフォーカスしてお伝えします"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"爆速でセットアップしてテストコードを書き始める方法"),(0,a.kt)("li",{parentName:"ul"},"最近流行ってるライブラリ"),(0,a.kt)("li",{parentName:"ul"},"可読性の高いテストコードの書き方"),(0,a.kt)("li",{parentName:"ul"},"サクッと運用に載せていく方法"))),e=>(0,a.kt)(n.Fragment,null,(0,a.kt)("h1",null,"利用するライブラリ")),e=>(0,a.kt)(n.Fragment,null,(0,a.kt)("h2",null,"Cypress"),(0,a.kt)("p",null,"デベロッパーフレンドリーなE2Eテストツール"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Chrome/Firefoxに対応"),(0,a.kt)("li",{parentName:"ul"},"テストコードの作成やデバッグを楽にする機能がいろいろある"))),e=>(0,a.kt)(n.Fragment,null,(0,a.kt)("h2",null,"testing-library"),(0,a.kt)("p",null,"「ユーザーと同じ目線でテストコードを書きたい」という思想から生まれたライブラリ"),(0,a.kt)("p",null,"アクセシビリティのためのAPIを使ってテストを書ける"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-html"},"<header>\n    <h1>Awesome webpage</h1>\n</header>\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"getByRole('banner', 'Awesome webpage')\n"))),e=>(0,a.kt)(n.Fragment,null,(0,a.kt)("h2",null,"testing-playground"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://chrome.google.com/webstore/detail/testing-playground/hejbmebodbijjdhflfknehhcgaklhano"},"https://chrome.google.com/webstore/detail/testing-playground/hejbmebodbijjdhflfknehhcgaklhano")),(0,a.kt)("p",null,"testing-libraryのクエリを調べるための Chrome Extension"),(0,a.kt)("p",null,(0,a.kt)("img",{src:l(4644),alt:"testing-playground"}))),e=>(0,a.kt)(n.Fragment,null,(0,a.kt)("h2",null,"インストール"),(0,a.kt)("p",null,"NodeJSのインストールが必要です"),(0,a.kt)("p",null,"Macの場合は以下"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"$ brew install node\n"))),e=>(0,a.kt)(n.Fragment,null,(0,a.kt)("h2",null,"インストール"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"$ mkdir jasst22tokyo\n$ cd jasst22tokyo\n$ npm install cypress @testing-library/cypress\n"))),e=>(0,a.kt)(n.Fragment,null,(0,a.kt)("h2",null,"起動"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"$ npx cypress open\n")),(0,a.kt)("p",null,"初回起動時に設定ファイルとサンプルのテストコードが生成されます")),e=>(0,a.kt)(n.Fragment,null,(0,a.kt)("p",null,(0,a.kt)("img",{src:l(6025),alt:"cypress_open"}))),e=>(0,a.kt)(n.Fragment,null,(0,a.kt)("p",null,(0,a.kt)("img",{src:l(9293),alt:"cypress_run"})),(0,a.kt)("p",null,"テストを実行すると実行結果が細かく表示されます")),e=>(0,a.kt)(n.Fragment,null,(0,a.kt)("h1",null,"ステップ1: Cypress Studio でテストコードを自動記録する")),e=>(0,a.kt)(n.Fragment,null,(0,a.kt)("h2",null,"Cypress Studio とは"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"テストコードを自動記録するためのツール"),(0,a.kt)("li",{parentName:"ul"},"テスト結果から続けてテストコードを追記してくれる"))),e=>(0,a.kt)(n.Fragment,null,(0,a.kt)("h2",null,"テスト対象"),(0,a.kt)("p",null,"Hotel Planisphere"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://hotel.testplanisphere.dev/ja/"},"https://hotel.testplanisphere.dev/ja/")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"自動テスト用のサンプルサイト"),(0,a.kt)("li",{parentName:"ul"},"（人によっては）親の顔より見たと思う"))),e=>(0,a.kt)(n.Fragment,null,(0,a.kt)("h2",null,"テストシナリオ"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://hotel.testplanisphere.dev/ja/index.html"},"https://hotel.testplanisphere.dev/ja/index.html")," にアクセスする"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"ログイン")," をクリックする"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"メールアドレス")," に ",(0,a.kt)("inlineCode",{parentName:"li"},"ichiro@example.com")," と入力する"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"パスワード")," に ",(0,a.kt)("inlineCode",{parentName:"li"},"password")," と入力する"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"ログイン")," をクリックする"))),e=>(0,a.kt)(n.Fragment,null,(0,a.kt)("h2",null,"まずはテストを書く土台を作っていく"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"integration")," フォルダ内に ",(0,a.kt)("inlineCode",{parentName:"p"},"login.js")," を作り、以下のように記述する"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"describe('Login', () => {\n  it('as a premium member', () => {\n    cy.visit(\"https://hotel.testplanisphere.dev/ja/index.html\");\n    // ここから先は自動記録でやってもらう\n  })\n})\n"))),e=>(0,a.kt)(n.Fragment,null,(0,a.kt)("h2",null,"Cypressを起動する"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"$ npx cypress open\n"))),e=>(0,a.kt)(n.Fragment,null,(0,a.kt)("h2",null,"自動記録する")),e=>(0,a.kt)(n.Fragment,null,(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"describe('Login', () => {\n  it('as a premium member', () => {\n    cy.visit(\"https://hotel.testplanisphere.dev/ja/index.html\");\n    /* ==== Generated with Cypress Studio ==== */\n    cy.get('#login-holder > .btn').click();\n    cy.get('#email').clear();\n    cy.get('#email').type('ichiro@example.com');\n    cy.get('#password').clear();\n    cy.get('#password').type('password');\n    cy.get('#login-button').click();\n    /* ==== End Cypress Studio ==== */\n  })\n})\n"))),e=>(0,a.kt)(n.Fragment,null,(0,a.kt)("h2",null,"ちょっと読みにくいので加工しましょう"),(0,a.kt)("p",null,"コメントアウトされている箇所は消しても大丈夫"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"describe('Login', () => {\n  it('as a premium member', () => {\n    cy.visit(\"https://hotel.testplanisphere.dev/ja/index.html\");\n    /* ==== Generated with Cypress Studio ==== */\n    cy.get('#login-holder > .btn').click();\n    // cy.get('#email').clear();\n    cy.get('#email').type('ichiro@example.com');\n    // cy.get('#password').clear();\n    cy.get('#password').type('password');\n    cy.get('#login-button').click();\n    /* ==== End Cypress Studio ==== */\n  })\n})\n"))),e=>(0,a.kt)(n.Fragment,null,(0,a.kt)("h1",null,"ステップ2: コードを読みやすくする")),e=>(0,a.kt)(n.Fragment,null,(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://hotel.testplanisphere.dev/ja/index.html"},"https://hotel.testplanisphere.dev/ja/index.html")," にアクセスする"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"ログイン")," をクリックする"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"メールアドレス")," に ",(0,a.kt)("inlineCode",{parentName:"li"},"ichiro@example.com")," と入力する"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"パスワード")," に ",(0,a.kt)("inlineCode",{parentName:"li"},"password")," と入力する"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"ログイン")," をクリックする")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"describe('Login', () => {\n  it('as a premium member', () => {\n    cy.visit(\"https://hotel.testplanisphere.dev/ja/index.html\");\n    cy.get('#login-holder >  .btn').click();\n    cy.get('#email').type('ichiro@example.com');\n    cy.get('#password').type('password');\n    cy.get('#login-button').click();\n  })\n})\n")),(0,a.kt)("p",null,"❌ 元のシナリオとテストコードの対応が取れていない")),e=>(0,a.kt)(n.Fragment,null,(0,a.kt)("h2",null,"理想はこう書きたい"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"describe('Login', () => {\n  it('as a premium member', () => {\n    cy.visit(\"https://hotel.testplanisphere.dev/ja/index.html\");\n    cy.get('ログイン').click();\n    cy.get('メールアドレス').type('ichiro@example.com');\n    cy.get('パスワード').type('password');\n    cy.get('ログイン').click();\n  })\n})\n"))),e=>(0,a.kt)(n.Fragment,null,(0,a.kt)("h2",null,"cy.contains() を使う"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://hotel.testplanisphere.dev/ja/index.html"},"https://hotel.testplanisphere.dev/ja/index.html")," にアクセスする"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"ログイン")," をクリックする"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"メールアドレス")," に ",(0,a.kt)("inlineCode",{parentName:"li"},"ichiro@example.com")," と入力する"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"パスワード")," に ",(0,a.kt)("inlineCode",{parentName:"li"},"password")," と入力する"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"ログイン")," をクリックする")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"describe('Login', () => {\n  it('as a premium member', () => {\n    cy.visit(\"https://hotel.testplanisphere.dev/ja/index.html\");\n    cy.contains('ログイン').click();\n    cy.contains('メールアドレス').type('ichiro@example.com')\n    cy.contains('パスワード').type('password')\n    cy.contains('ログイン').click();\n  })\n})\n")),(0,a.kt)("p",null,"元のシナリオと同じ書き方に出来た")),e=>(0,a.kt)(n.Fragment,null,(0,a.kt)("h2",null,"あいまいな部分を排除する"),(0,a.kt)("p",null,"よく見ると「ログイン」というボタンが2つありますね"),(0,a.kt)("p",null,(0,a.kt)("img",{src:l(7037),alt:"duplicated-query"}))),e=>(0,a.kt)(n.Fragment,null,(0,a.kt)("h2",null,"構造に着目しましょう"),(0,a.kt)("p",null,(0,a.kt)("img",{src:l(8428),alt:"ui-structure"})),(0,a.kt)("p",null,"ユーザーはナビゲーションバーとフォームの「ログイン」ボタンを使い分けているはず"),(0,a.kt)("p",null,"要素選択も同じようにします")),e=>(0,a.kt)(n.Fragment,null,(0,a.kt)("h2",null,(0,a.kt)("inlineCode",{parentName:"h2"},"within()")," を使う"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"describe('Login', () => {\n  it('as a premium member', () => {\n    cy.visit(\"https://hotel.testplanisphere.dev/ja/index.html\");\n\n    // ナビゲーションバーの中の要素を操作\n    cy.get('nav').within(() => {\n      cy.contains('ログイン').click();\n    })\n\n    // フォームの中の要素を操作\n    cy.get('form').within(() => {\n      cy.contains('メールアドレス').type('ichiro@example.com')\n      cy.contains('パスワード').type('password')\n      cy.contains('ログイン').click();\n    })\n  })\n})\n"))),e=>(0,a.kt)(n.Fragment,null,(0,a.kt)("h2",null,"テストシナリオをコードに変えていきましょう"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://hotel.testplanisphere.dev/ja/index.html"},"https://hotel.testplanisphere.dev/ja/index.html")," にアクセスする"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"ログイン")," をクリックする"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"メールアドレス")," に ",(0,a.kt)("inlineCode",{parentName:"li"},"ichiro@example.com")," と入力する"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"パスワード")," に ",(0,a.kt)("inlineCode",{parentName:"li"},"password")," と入力する"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"ログイン")," をクリックする"))),e=>(0,a.kt)(n.Fragment,null,(0,a.kt)("h2",null,"要素の取得"),(0,a.kt)("p",null,"前述の ",(0,a.kt)("inlineCode",{parentName:"p"},"testing-playground")," を用います"),(0,a.kt)("p",null,(0,a.kt)("img",{src:l(6698),alt:"suggested-query"}))),e=>(0,a.kt)(n.Fragment,null,(0,a.kt)("h2",null,"テストシナリオをテストコードに変えていきましょう"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://hotel.testplanisphere.dev/ja/index.html"},"https://hotel.testplanisphere.dev/ja/index.html")," にアクセスする"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"ログイン")," をクリックする"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"メールアドレス")," に ",(0,a.kt)("inlineCode",{parentName:"li"},"ichiro@example.com")," と入力する"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"パスワード")," に ",(0,a.kt)("inlineCode",{parentName:"li"},"password")," と入力する"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"ログイン")," をクリックする")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"cy.url('https://hotel.testplanisphere.dev/ja/index.html')\ncy.\n\n"))),e=>(0,a.kt)(n.Fragment,null)],p=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],k=[{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{}],m={};function u(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",i({},m,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",null,"60分で学ぶ実践E2Eテスト（実装編）"),(0,a.kt)("hr",null),(0,a.kt)("h1",null,"はじめに"),(0,a.kt)("hr",null),(0,a.kt)("h2",null,"E2Eテストコード、書いてますか？"),(0,a.kt)("hr",null),(0,a.kt)("h2",null,"何に困ってますか？"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"書きたいと思ってるんだけど、ググるといろんなやり方が出てきて、どれが良いやり方なのかわからない"),(0,a.kt)("li",{parentName:"ul"},"昔チャレンジしたんだけど、メンテナンスが上手く行かなかった"),(0,a.kt)("li",{parentName:"ul"},"勉強する時間がない、正解を教えてほしい")),(0,a.kt)("hr",null),(0,a.kt)("h2",null,"今日話すこと"),(0,a.kt)("p",null,"時間もあんまり無いので、 ",(0,a.kt)("strong",{parentName:"p"},"個人的ベストプラクティス")," にフォーカスしてお伝えします"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"爆速でセットアップしてテストコードを書き始める方法"),(0,a.kt)("li",{parentName:"ul"},"最近流行ってるライブラリ"),(0,a.kt)("li",{parentName:"ul"},"可読性の高いテストコードの書き方"),(0,a.kt)("li",{parentName:"ul"},"サクッと運用に載せていく方法")),(0,a.kt)("hr",null),(0,a.kt)("h1",null,"利用するライブラリ"),(0,a.kt)("hr",null),(0,a.kt)("h2",null,"Cypress"),(0,a.kt)("p",null,"デベロッパーフレンドリーなE2Eテストツール"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Chrome/Firefoxに対応"),(0,a.kt)("li",{parentName:"ul"},"テストコードの作成やデバッグを楽にする機能がいろいろある")),(0,a.kt)("hr",null),(0,a.kt)("h2",null,"testing-library"),(0,a.kt)("p",null,"「ユーザーと同じ目線でテストコードを書きたい」という思想から生まれたライブラリ"),(0,a.kt)("p",null,"アクセシビリティのためのAPIを使ってテストを書ける"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-html"},"<header>\n    <h1>Awesome webpage</h1>\n</header>\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"getByRole('banner', 'Awesome webpage')\n")),(0,a.kt)("hr",null),(0,a.kt)("h2",null,"testing-playground"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://chrome.google.com/webstore/detail/testing-playground/hejbmebodbijjdhflfknehhcgaklhano"},"https://chrome.google.com/webstore/detail/testing-playground/hejbmebodbijjdhflfknehhcgaklhano")),(0,a.kt)("p",null,"testing-libraryのクエリを調べるための Chrome Extension"),(0,a.kt)("p",null,(0,a.kt)("img",{src:l(4644),alt:"testing-playground"})),(0,a.kt)("hr",null),(0,a.kt)("h2",null,"インストール"),(0,a.kt)("p",null,"NodeJSのインストールが必要です"),(0,a.kt)("p",null,"Macの場合は以下"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"$ brew install node\n")),(0,a.kt)("hr",null),(0,a.kt)("h2",null,"インストール"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"$ mkdir jasst22tokyo\n$ cd jasst22tokyo\n$ npm install cypress @testing-library/cypress\n")),(0,a.kt)("hr",null),(0,a.kt)("h2",null,"起動"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"$ npx cypress open\n")),(0,a.kt)("p",null,"初回起動時に設定ファイルとサンプルのテストコードが生成されます"),(0,a.kt)("hr",null),(0,a.kt)("p",null,(0,a.kt)("img",{src:l(6025),alt:"cypress_open"})),(0,a.kt)("hr",null),(0,a.kt)("p",null,(0,a.kt)("img",{src:l(9293),alt:"cypress_run"})),(0,a.kt)("p",null,"テストを実行すると実行結果が細かく表示されます"),(0,a.kt)("hr",null),(0,a.kt)("h1",null,"ステップ1: Cypress Studio でテストコードを自動記録する"),(0,a.kt)("hr",null),(0,a.kt)("h2",null,"Cypress Studio とは"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"テストコードを自動記録するためのツール"),(0,a.kt)("li",{parentName:"ul"},"テスト結果から続けてテストコードを追記してくれる")),(0,a.kt)("hr",null),(0,a.kt)("h2",null,"テスト対象"),(0,a.kt)("p",null,"Hotel Planisphere"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://hotel.testplanisphere.dev/ja/"},"https://hotel.testplanisphere.dev/ja/")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"自動テスト用のサンプルサイト"),(0,a.kt)("li",{parentName:"ul"},"（人によっては）親の顔より見たと思う")),(0,a.kt)("hr",null),(0,a.kt)("h2",null,"テストシナリオ"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://hotel.testplanisphere.dev/ja/index.html"},"https://hotel.testplanisphere.dev/ja/index.html")," にアクセスする"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"ログイン")," をクリックする"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"メールアドレス")," に ",(0,a.kt)("inlineCode",{parentName:"li"},"ichiro@example.com")," と入力する"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"パスワード")," に ",(0,a.kt)("inlineCode",{parentName:"li"},"password")," と入力する"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"ログイン")," をクリックする")),(0,a.kt)("hr",null),(0,a.kt)("h2",null,"まずはテストを書く土台を作っていく"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"integration")," フォルダ内に ",(0,a.kt)("inlineCode",{parentName:"p"},"login.js")," を作り、以下のように記述する"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"describe('Login', () => {\n  it('as a premium member', () => {\n    cy.visit(\"https://hotel.testplanisphere.dev/ja/index.html\");\n    // ここから先は自動記録でやってもらう\n  })\n})\n")),(0,a.kt)("hr",null),(0,a.kt)("h2",null,"Cypressを起動する"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"$ npx cypress open\n")),(0,a.kt)("hr",null),(0,a.kt)("h2",null,"自動記録する"),(0,a.kt)("hr",null),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"describe('Login', () => {\n  it('as a premium member', () => {\n    cy.visit(\"https://hotel.testplanisphere.dev/ja/index.html\");\n    /* ==== Generated with Cypress Studio ==== */\n    cy.get('#login-holder > .btn').click();\n    cy.get('#email').clear();\n    cy.get('#email').type('ichiro@example.com');\n    cy.get('#password').clear();\n    cy.get('#password').type('password');\n    cy.get('#login-button').click();\n    /* ==== End Cypress Studio ==== */\n  })\n})\n")),(0,a.kt)("hr",null),(0,a.kt)("h2",null,"ちょっと読みにくいので加工しましょう"),(0,a.kt)("p",null,"コメントアウトされている箇所は消しても大丈夫"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"describe('Login', () => {\n  it('as a premium member', () => {\n    cy.visit(\"https://hotel.testplanisphere.dev/ja/index.html\");\n    /* ==== Generated with Cypress Studio ==== */\n    cy.get('#login-holder > .btn').click();\n    // cy.get('#email').clear();\n    cy.get('#email').type('ichiro@example.com');\n    // cy.get('#password').clear();\n    cy.get('#password').type('password');\n    cy.get('#login-button').click();\n    /* ==== End Cypress Studio ==== */\n  })\n})\n")),(0,a.kt)("hr",null),(0,a.kt)("h1",null,"ステップ2: コードを読みやすくする"),(0,a.kt)("hr",null),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://hotel.testplanisphere.dev/ja/index.html"},"https://hotel.testplanisphere.dev/ja/index.html")," にアクセスする"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"ログイン")," をクリックする"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"メールアドレス")," に ",(0,a.kt)("inlineCode",{parentName:"li"},"ichiro@example.com")," と入力する"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"パスワード")," に ",(0,a.kt)("inlineCode",{parentName:"li"},"password")," と入力する"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"ログイン")," をクリックする")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"describe('Login', () => {\n  it('as a premium member', () => {\n    cy.visit(\"https://hotel.testplanisphere.dev/ja/index.html\");\n    cy.get('#login-holder >  .btn').click();\n    cy.get('#email').type('ichiro@example.com');\n    cy.get('#password').type('password');\n    cy.get('#login-button').click();\n  })\n})\n")),(0,a.kt)("p",null,"❌ 元のシナリオとテストコードの対応が取れていない"),(0,a.kt)("hr",null),(0,a.kt)("h2",null,"理想はこう書きたい"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"describe('Login', () => {\n  it('as a premium member', () => {\n    cy.visit(\"https://hotel.testplanisphere.dev/ja/index.html\");\n    cy.get('ログイン').click();\n    cy.get('メールアドレス').type('ichiro@example.com');\n    cy.get('パスワード').type('password');\n    cy.get('ログイン').click();\n  })\n})\n")),(0,a.kt)("hr",null),(0,a.kt)("h2",null,"cy.contains() を使う"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://hotel.testplanisphere.dev/ja/index.html"},"https://hotel.testplanisphere.dev/ja/index.html")," にアクセスする"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"ログイン")," をクリックする"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"メールアドレス")," に ",(0,a.kt)("inlineCode",{parentName:"li"},"ichiro@example.com")," と入力する"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"パスワード")," に ",(0,a.kt)("inlineCode",{parentName:"li"},"password")," と入力する"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"ログイン")," をクリックする")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"describe('Login', () => {\n  it('as a premium member', () => {\n    cy.visit(\"https://hotel.testplanisphere.dev/ja/index.html\");\n    cy.contains('ログイン').click();\n    cy.contains('メールアドレス').type('ichiro@example.com')\n    cy.contains('パスワード').type('password')\n    cy.contains('ログイン').click();\n  })\n})\n")),(0,a.kt)("p",null,"元のシナリオと同じ書き方に出来た"),(0,a.kt)("hr",null),(0,a.kt)("h2",null,"あいまいな部分を排除する"),(0,a.kt)("p",null,"よく見ると「ログイン」というボタンが2つありますね"),(0,a.kt)("p",null,(0,a.kt)("img",{src:l(7037),alt:"duplicated-query"})),(0,a.kt)("hr",null),(0,a.kt)("h2",null,"構造に着目しましょう"),(0,a.kt)("p",null,(0,a.kt)("img",{src:l(8428),alt:"ui-structure"})),(0,a.kt)("p",null,"ユーザーはナビゲーションバーとフォームの「ログイン」ボタンを使い分けているはず"),(0,a.kt)("p",null,"要素選択も同じようにします"),(0,a.kt)("hr",null),(0,a.kt)("h2",null,(0,a.kt)("inlineCode",{parentName:"h2"},"within()")," を使う"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"describe('Login', () => {\n  it('as a premium member', () => {\n    cy.visit(\"https://hotel.testplanisphere.dev/ja/index.html\");\n\n    // ナビゲーションバーの中の要素を操作\n    cy.get('nav').within(() => {\n      cy.contains('ログイン').click();\n    })\n\n    // フォームの中の要素を操作\n    cy.get('form').within(() => {\n      cy.contains('メールアドレス').type('ichiro@example.com')\n      cy.contains('パスワード').type('password')\n      cy.contains('ログイン').click();\n    })\n  })\n})\n")),(0,a.kt)("hr",null),(0,a.kt)("h2",null,"テストシナリオをコードに変えていきましょう"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://hotel.testplanisphere.dev/ja/index.html"},"https://hotel.testplanisphere.dev/ja/index.html")," にアクセスする"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"ログイン")," をクリックする"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"メールアドレス")," に ",(0,a.kt)("inlineCode",{parentName:"li"},"ichiro@example.com")," と入力する"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"パスワード")," に ",(0,a.kt)("inlineCode",{parentName:"li"},"password")," と入力する"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"ログイン")," をクリックする")),(0,a.kt)("hr",null),(0,a.kt)("h2",null,"要素の取得"),(0,a.kt)("p",null,"前述の ",(0,a.kt)("inlineCode",{parentName:"p"},"testing-playground")," を用います"),(0,a.kt)("p",null,(0,a.kt)("img",{src:l(6698),alt:"suggested-query"})),(0,a.kt)("hr",null),(0,a.kt)("h2",null,"テストシナリオをテストコードに変えていきましょう"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://hotel.testplanisphere.dev/ja/index.html"},"https://hotel.testplanisphere.dev/ja/index.html")," にアクセスする"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"ログイン")," をクリックする"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"メールアドレス")," に ",(0,a.kt)("inlineCode",{parentName:"li"},"ichiro@example.com")," と入力する"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"パスワード")," に ",(0,a.kt)("inlineCode",{parentName:"li"},"password")," と入力する"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"ログイン")," をクリックする")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"cy.url('https://hotel.testplanisphere.dev/ja/index.html')\ncy.\n\n")),(0,a.kt)("hr",null))}u.isMDXComponent=!0},5516:(e,t,l)=>{"use strict";l.r(t)},3447:(e,t,l)=>{var n={"./index.md":2904};function a(e){var t=i(e);return l(t)}function i(e){if(!l.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}a.keys=function(){return Object.keys(n)},a.resolve=i,e.exports=a,a.id=3447},6025:(e,t,l)=>{"use strict";e.exports=l.p+"affe6e06fcd384533418.webp"},9293:(e,t,l)=>{"use strict";e.exports=l.p+"02f21c4b6096b1cb9d5d.webp"},7037:(e,t,l)=>{"use strict";e.exports=l.p+"94a9c3bcd95571e3edcc.webp"},6698:(e,t,l)=>{"use strict";e.exports=l.p+"e252d23d2e35bf0483ce.webp"},4644:(e,t,l)=>{"use strict";e.exports=l.p+"732a5cecf3f323bd2661.webp"},8428:(e,t,l)=>{"use strict";e.exports=l.p+"1e69316fe28c3b85e7d7.webp"}},e=>{e.O(0,[179],(()=>{[901,921,626].map(e.E)}),5);var t=t=>e(e.s=t);e.O(0,[736],(()=>(t(7751),t(6905),t(9969))));e.O()}]);